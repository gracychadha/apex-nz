!function(){function e(e){if(/^\s+$/.test(e)||""==e||null==e||void 0===e)return;let t=[],n=[];try{t=localStorage.getItem("search-history")??"[]",t=JSON.parse(t)}catch(e){}t=t.filter(function(t){return t!==e}),n.push(e),t.forEach(function(e){n.push(e)}),localStorage.setItem("search-history",JSON.stringify(n.filter(function(e,t){return t<20})))}let t=null,n=document.querySelectorAll('[data-isopenhistory="on"]');function r(e,t){var n="";if(t&&t.length){for(let e=0;e<t.length;e++){var r=t[e];n+="<li class='selectLi' data-id='"+r.id+"' ><span class='selectLiText'>"+r.name+"</span></li>"}e.html(n),function(e){var t=e.find(".selectLi"),n=e.parents(".searchSelectBox"),r=n.find(".classifyInput"),a=n.find(".searchSelectSpan");t.on("click",function(){-1==$(this).attr("class").indexOf("selected")?($(this).addClass("selected"),$(this).parents(".searchSelectUl").removeClass("searchSelectShow")):$(this).removeClass("selected");for(var t=e.find(".selected"),n=[],i=[],c=0;c<t.length;c++){var s=$(t[c]).attr("data-id"),l=$(t[c]).find(".selectLiText").html();n.push(s),i.push(l)}if(n.length)r.val(n.join(",")),a.html(i.join(" "));else{r.val("");var o=a.attr("data-prompt")||"";a.html(o)}})}(e)}}Array.from(n).forEach(function(n){let r=[];try{r=localStorage.getItem("search-history")??"[]",r=JSON.parse(r)}catch(e){}n.querySelector(".btnCont");const a=n.parentNode;let i,c,s;a.style.cssText="position:relative";const l=n.querySelector(".searchInput");n.addEventListener("submit",function(){return e(l.value),!1},!1);const o=n;l.addEventListener("click",function(){if(r.length&&!c){let e="";r.forEach(function(t){e+='<li><div class="text">'+t+'</div><div class="del"><img width="17" src="https://img.bjyyb.net/Response/images/svgs/del.svg" /></div></li>'}),i=document.createElement("ul"),c=document.createElement("div"),s=document.createElement("div"),i.innerHTML=e;const d=o.getAttribute("data-search_history"),h=o.getAttribute("data-search_history_clear");s.innerHTML="<div>"+d+'</div><div class="history-clear">'+h+"</div>",s.className="search-history-tool",c.className="search-history",c.appendChild(s),c.appendChild(i),s.querySelector(".history-clear").addEventListener("click",function(){clearTimeout(t),a.removeChild(c),c=null,r=[],localStorage.setItem("search-history",JSON.stringify([]))}),Array.from(i.querySelectorAll("li")).forEach(function(e,n){e.querySelector(".text").addEventListener("click",function(n){let r=e;console.log(".text"),l.value=r.innerText,clearTimeout(t),a.removeChild(c),c=null,n.stopPropagation(),n.preventDefault()},!1),e.querySelector(".del").addEventListener("click",function(a){let c=n;r=r.filter(function(e,t){return t!=c}),localStorage.setItem("search-history",JSON.stringify(r)),clearTimeout(t),i.removeChild(e),a.stopPropagation(),a.preventDefault()},!1)}),c.addEventListener("mouseleave",function(){clearTimeout(t),t=setTimeout(()=>{c&&(a.removeChild(c),c=null)},200)});const u=n.getBoundingClientRect();c.style.top=u.height+5+"px",a.appendChild(c)}}),l.addEventListener("blur",function(){t=setTimeout(()=>{c&&a&&(a.removeChild(c),c=null)},200)})}),$(".searchFilterBox").length&&(!function(){var e=[],t=$(".searchSelectDown");if(!t.length)return!1;for(var n=0;n<t.length;n++){var a=$(t[n]).attr("data-classify");a&&-1==e.indexOf(a)&&e.push(a)}if(e.length){var i=$('meta[name="md5SiteId"]').attr("content"),c=$('meta[name="interfaceAddress"]').attr("content")+"Home/Category/getNextCategories";Public.newFetch(c,{method:"post",async:!0,body:{site_id:i,classify:e},success:function(e){200==e.status&&function(e){for(var t=$(".searchSelectDown"),n=0;n<t.length;n++){var a=$(t[n]).attr("data-classify");a&&e[a]&&r($(t[n]),e[a])}}(e.data)},error:function(e){console.log("失败",e)}})}}(),$(".searchFilterBox").find(".selectClickDom").on("click",function(){var e=$(this).parents(".searchSelectBox"),t=$(e).find(".searchSelectDown"),n=t.attr("class");if($(".searchSelectDown").removeClass("searchSelectShow"),-1==n.indexOf("searchSelectShow")){if("mo"==($("meta[name='sitetype']").attr("content")||"pc")){var r=e.parents(".searchSelect").outerWidth(!0);t.css({width:r,"max-width":"none"})}t.addClass("searchSelectShow")}}));var a=document.querySelectorAll(".searchBox");$(a).find(".btnCont").on("click",function(){var t=$(this).parents(".searchBox").find(".hidden");e(this.parentNode.querySelector(".searchInput").value),t.trigger("click")}),$(a).find(".searchInput").on("keydown",function(e){"Enter"!==e.key&&"Return"!==e.key&&13!==e.keyCode||$(this).parents(".searchBox").find(".hidden").trigger("click")})}(window);